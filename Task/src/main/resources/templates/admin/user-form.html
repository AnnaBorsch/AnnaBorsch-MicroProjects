<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Форма пользователя</title>
    <meta charset="UTF-8">
</head>
<body>
<h1 th:text="${user.id != null} ? 'Редактировать пользователя' : 'Создать пользователя'">
    Форма пользователя
</h1>

<!-- Форма для редактирования -->
<form th:if="${user.id != null}" th:action="@{'/admin/users/' + ${user.id}}" method="post">
    <div>
        <label>Username:</label>
        <input type="text" name="username" th:value="${user.username}" required>
    </div>

    <div>
        <label>Password:</label>
        <input type="password" name="password" placeholder="Оставьте пустым чтобы не менять">
        <small>Оставьте пустым, если не хотите менять пароль</small>
    </div>

    <div>
        <label>Email:</label>
        <input type="email" name="email" th:value="${user.email}" required>
    </div>

    <div>
        <label>Роли:</label><br>
        <input type="checkbox" name="roles" value="ROLE_USER"
               th:checked="${user.roles.![name].contains('ROLE_USER')}"> USER<br>
        <input type="checkbox" name="roles" value="ROLE_ADMIN"
               th:checked="${user.roles.![name].contains('ROLE_ADMIN')}"> ADMIN
    </div>

    <div>
        <button type="submit">Обновить</button>
        <a th:href="@{/admin/users}">Отмена</a>
    </div>
</form>

<!-- Форма для создания -->
<form th:if="${user.id == null}" th:action="@{/admin/users}" method="post">
    <div>
        <label>Username:</label>
        <input type="text" name="username" required>
    </div>

    <div>
        <label>Password:</label>
        <input type="password" name="password" required>
    </div>

    <div>
        <label>Email:</label>
        <input type="email" name="email" required>
    </div>

    <div>
        <label>Роли:</label><br>
        <input type="checkbox" name="roles" value="ROLE_USER"> USER<br>
        <input type="checkbox" name="roles" value="ROLE_ADMIN"> ADMIN
    </div>

    <div>
        <button type="submit">Создать</button>
        <a th:href="@{/admin/users}">Отмена</a>
    </div>
</form>
</body>
</html>